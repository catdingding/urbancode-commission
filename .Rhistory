setwd("D:/GitHub/urbancode-commission")
source("tpup.R")
Sys.setlocale(category='LC_ALL', locale='C')
source("tpup.R")
debug(tp_pdf_to_html)
tp_pdf_to_html()
paste('"D:/xpdf/bin64/pdftohtml.exe"',uri, dir_name[i])
source("tpup.R")
debug(tp_pdf_to_html)
tp_pdf_to_html()
paste('"D:/xpdf/bin64/pdftohtml.exe"',uri, dir_name)
weblist<-read.csv("tp_web_list.csv")
weblist<-read.csv("tp_web_list.csv",encoding="utf-8")
weblist
head(weblist)
View(weblist)
View(weblist[,2])
head(weblist[,2])
weblist<-read.csv("tp_web_list.csv",encoding="utf-8",strongasFactor=FALSE)
weblist<-read.csv("tp_web_list.csv",encoding="utf-8",stringasFactor=FALSE)
?read.csv
weblist<-read.csv("tp_web_list.csv",encoding="utf-8",stringsAsFactors=FALSE)
gsub("續","_2",gsub("(次)?(委員會)?(會)?(議紀錄)?","",
gsub("臺北市都市計畫委員會第","tpup",gsub("\\(|\\)| ","",dir("./record/tpup/raw")))))
gsub("續","_2",gsub("(次)?(委員會)?(會)?(議紀錄)?","",
gsub("臺北市都市計畫委員會第","tpup",gsub("\\(|\\)| ","",weblist[,2])))))
gsub("續","_2",gsub("(次)?(委員會)?(會)?(議紀錄)?","",
gsub("臺北市都市計畫委員會第","tpup",gsub("\\(|\\)| ","",weblist[,2]))))
weblist[,2]
test<-weblist[,2]
test
Encoding(test)
Encoding(test)<-"BIG5"
Encoding(test)
test
gsub("續","_2",gsub("(次)?(委員會)?(會)?(議紀錄)?","",
gsub("臺北市都市計畫委員會第","tpup",gsub("\\(|\\)| ","",test))))
gsub("續","_2",gsub("(次)?(委員會)?(會)?(議紀錄)?","",gsub("臺北市都市計畫委員會第","tpup",gsub("\\(|\\)| ","",test))))
weblist<-read.csv("tp_web_list.csv",encoding="BIG5",stringsAsFactors=FALSE)
weblist
weblist[,2]
gsub("續","_2",gsub("(次)?(委員會)?(會)?(議紀錄)?","",gsub("臺北市都市計畫委員會第","tpup",gsub("\\(|\\)| ","",weblist[,2]))))
weblist[,2]
Encoding(weblist[,2])
weblist<-read.csv("tp_web_list.csv",encoding="big5",stringsAsFactors=FALSE)
weblist
weblist[,1]
head(weblist[,1])
head(weblist[,2])
weblist<-read.csv("tp_web_list.csv",encoding="big5",stringsAsFactors=FALSE)
head(weblist[,2])
encoding(weblist[,2])
Encoding(weblist[,2])
gsub("([ab])", "\\1_\\1_", "abc and ABC")
gsub("([0-9])", "\\1", weblist[,2])
gsub("([0-9])", "", weblist[,2])
gsub(".*([0-9]).*", "\\2", weblist[,2])
gsub(".*([0-9]).*", "\\1", weblist[,2])
gsub(".*([000-999]).*", "\\1", weblist[,2])
gsub(".*([0-9]+).*", "\\1", weblist[,2])
gsub(".*([0-9])+.*", "\\1", weblist[,2])
grepl("([0-9])+", weblist[,2])
grepl("([0-9])+", weblist[,2]),\\1
str_match("([0-9])+", weblist[,2]),\\1
str_match("([0-9])+", weblist[,2])
library("stringr")
str_match("([0-9])+", weblist[,2])
str_match("([0-9]){3}+", weblist[,2])
str_match("([0-9]){3}", weblist[,2])
str_match(weblist[,2],"([0-9]){3}")
head(str_match(weblist[,2],"([0-9]){3}"))
head(str_match(weblist[,2],"([0-9]){3}")[,1])
grepl("續會",weblist[,2])
weblist[grepl("續會",weblist[,2])[]
weblist[grepl("續會",weblist[,2])]
weblist[grepl("續會",weblist[,2]),]
weblist[grepl("續會",weblist[,2])]
grepl("續會",weblist[,2])
x<-"續會"
grepl(x,weblist[,2])
weblist[grepl(x,weblist[,2])[]
grepl(x,weblist[,2])]
weblist[grepl(x,weblist[,2])
weblist[grepl(x,weblist[,2]),]
weblist[,2]
grepl((0-9),weblist[,2])]
grepl((0-9),weblist[,2])
grepl("(0-9)",weblist[,2])
grepl("[0-0]",weblist[,2])
grepl("[0-9]",weblist[,2])
grepl(x,weblist[,2])
weblist[,2]
test
grepl(x,test)
Encoding(test)
iconv(test,"big5","utf-8")
test<-iconv(test,"big5","utf-8")
iconv(test,"big5","utf-8")
grepl(x,test)
grepl("[0-9]",test)
test
library(bitops)
library(RCurl)
library(XML)
Sys.setlocale(category='LC_ALL', locale='C')
get_url<-getURL("http://www.tupc.gov.taipei/lp.asp?CtNode=6308&CtUnit=4388&BaseDSD=7&mp=120021&nowPage=1&pagesize=200", encoding="utf-8")
get_url_parse<-htmlParse(get_url, encoding="utf-8")
link<-xpathSApply(get_url_parse,"//div[@class='list']/ul/li/a",xmlAttrs)
link<-data.frame(weblink=link[1,],record_name=link[2,],stringsAsFactors = FALSE)
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
txt
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
txt<-iconv(URLdecode(txt),"utf-8","big5")
link[i,2]<-txt
}
txt
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
##txt<-iconv(URLdecode(txt),"utf-8","big5")
link[i,2]<-txt
}
txt
link[i,2]
link
link[,2]
Encoding(link[,2])
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
txt<-iconv(URLdecode(txt),"utf-8","big5")
link[i,2]<-txt
}
txt
link[,2]
get_url<-getURL("http://www.tupc.gov.taipei/lp.asp?CtNode=6308&CtUnit=4388&BaseDSD=7&mp=120021&nowPage=1&pagesize=200", encoding="utf-8")
get_url_parse<-htmlParse(get_url, encoding="utf-8")
link<-xpathSApply(get_url_parse,"//div[@class='list']/ul/li/a",xmlAttrs)
link<-data.frame(weblink=link[1,],record_name=link[2,],stringsAsFactors = FALSE)
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
txt<-iconv(URLdecode(txt),"utf-8","big5")
link[i,2]<-txt
}
link[,2]
Encoding(link[,2])
link[179,2]
grep("北",link[179,2])
grepl("北",link[179,2])
grepl("北",link[179,2])
library(bitops)
library(RCurl)
library(XML)
Sys.setlocale(category='LC_ALL', locale='C')
get_url<-getURL("http://www.tupc.gov.taipei/lp.asp?CtNode=6308&CtUnit=4388&BaseDSD=7&mp=120021&nowPage=1&pagesize=200", encoding="utf-8")
get_url_parse<-htmlParse(get_url, encoding="utf-8")
link<-xpathSApply(get_url_parse,"//div[@class='list']/ul/li/a",xmlAttrs)
link<-data.frame(weblink=link[1,],record_name=link[2,],stringsAsFactors = FALSE)
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
##txt<-iconv(URLdecode(txt),"utf-8","big5")
link[i,2]<-txt
}
link[,2]
Encoding(link[,2])
library(bitops)
library(RCurl)
library(XML)
Sys.setlocale(category='LC_ALL', locale='C')
get_url<-getURL("http://www.tupc.gov.taipei/lp.asp?CtNode=6308&CtUnit=4388&BaseDSD=7&mp=120021&nowPage=1&pagesize=200", encoding="utf-8")
get_url_parse<-htmlParse(get_url, encoding="utf-8")
link<-xpathSApply(get_url_parse,"//div[@class='list']/ul/li/a",xmlAttrs)
link<-data.frame(weblink=link[1,],record_name=link[2,],stringsAsFactors = FALSE)
for(i in 1:nrow(link)){
link[i,1]<-paste("http://www.tupc.gov.taipei/",link[i,1],sep="")
txt<-link[i,2]
txt<-gsub(">","",gsub("<","%",txt))
txt<-iconv(URLdecode(txt),"utf-8","big5")
link[i,2]<-txt
}
link[,2]
Encoding(link[,2])
grepl(iconv("北","utf-8","big5"),link[179,2])
grep(iconv("北","utf-8","big5"),link[179,2])
x<-iconv("北","utf-8","big5")
grep(x,link[179,2])
grep(x,link[179,2])
grepl(x,link[179,2])
indi1<-iconv("第","utf-8","big5")
indi2<-iconv("次","utf-8","big5")
indi3<-iconb("續","utf-8","big5")
indi1<-iconv("第","utf-8","big5")
indi2<-iconv("次","utf-8","big5")
indi3<-iconv("續","utf-8","big5")
indi.times<-paste(".*",indi1,"([0-9]++)",indi2,".*",sep="")
indi.times
gsub(indi.times,"\\1",link[,2])
test
link[,2]
gsub(indi.times,"\\1",link[,2])
indi1<-iconv("第","utf-8","big5")
indi2<-iconv("次","utf-8","big5")
indi.times<-paste(".*",indi1,"([0-9])+",indi2,".*",sep="")
indi.con<-iconv("續","utf-8","big5")
gsub(indi.times,"\\1",link[,2])
indi1<-iconv("第","utf-8","big5")
indi2<-iconv("次","utf-8","big5")
indi.times<-paste(".*",indi1,"([0-9])([0-9])([0-9])",indi2,".*",sep="")
indi.con<-iconv("續","utf-8","big5")
gsub(indi.times,"\\1",link[,2])
indi1<-iconv("第","utf-8","big5")
indi2<-iconv("次","utf-8","big5")
indi.times<-paste(".*",indi1,"([0-9][0-9][0-9])",indi2,".*",sep="")
indi.con<-iconv("續","utf-8","big5")
gsub(indi.times,"\\1",link[,2])
txt<-paste("tpup",gsub(indi.times,"\\1",txt),sep="")
txt
source("tpup.R")
tpup_parse1()
source("tpup.R")
tpup_parse1()
source("tpup.R")
tpup_parse2()
source("tpup.R")
tp_dlrecord("./record/tpup/tpup_link_list.csv")
source("tpup.R")
tp_dlrecord("./record/tpup/tpup_link_list.csv")
